<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Godox</title>
</head>




<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.2.0/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.1/css/dataTables.bootstrap5.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/select/1.5.0/css/select.bootstrap5.min.css">
<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
<script src="https://cdn.datatables.net/1.13.1/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.1/js/dataTables.bootstrap5.min.js"></script>
<script src="https://cdn.datatables.net/rowreorder/1.3.1/js/dataTables.rowReorder.min.js"></script>
<script src="https://cdn.datatables.net/responsive/2.4.0/js/dataTables.responsive.min.js"></script>
<link rel="stylesheet" href="https://cdn.datatables.net/rowreorder/1.3.1/css/rowReorder.dataTables.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.4.0/css/responsive.dataTables.min.css">

<body class="row container-fluid m-0 p-0">




  <nav class="navbar bg-dark col-sm-12">
    <div class="container-fluid">
      <a class="navbar-brand px-5" href="/admindashboard" style="color: white;">Admin</a>
      <a href="/adminlogout"> <button class="btn btn-dark logoutbt "
          style="margin-top: 0.5%; float: right; font-size: 20px;">Logout</button></a>


    </div>
  </nav>


  <div class="d-flex flex-column align-items-center bg-dark  col-sm-2" style=" min-height: 94.2vh;">
    <a href="/admindashboard" class="home-txt btn btn-dark my-5"
      style="text-decoration: none ; color: rgb(255, 255, 255); font-size: 20px;"> <b>Dashboard</b> </a>
    <a href="/admincustomer" class="prodect-txt btn btn-dark"
      style="text-decoration: none ; color: rgb(255, 255, 255);font-size: 20px; "> <b> Customers</b></a>
    <a href="/adminproducts" class="prodect-txt btn btn-dark my-5"
      style="text-decoration: none ; color: rgb(255, 255, 255); font-size: 20px; "> <b>Products</b> </a>
    <a href="/admincategory" class="prodect-txt btn btn-dark"
      style="text-decoration: none ; color: rgb(255, 255, 255); font-size: 20px; "> <b>Category</b> </a>
    <a href="/adminorder" class="prodect-txt  btn btn-dark my-5"
      style="text-decoration: none ; color: rgb(255, 255, 255); font-size: 20px; "> <b>Order</b> </a>
    <a href="/admincoupons" class="prodect-txt  btn btn-dark"
      style="text-decoration: none ; color: rgb(255, 255, 255); font-size: 20px;"> <b>Coupons</b> </a>
    <a href="/adminbanner" class="prodect-txt btn btn-dark my-5"
      style="text-decoration: none ; color: rgb(255, 255, 255); font-size: 20px; "> <b> Banner</b></a>


  </div>
  <div class="container-fluid  col-sm-10">
    <h1 class="mt-4 text-center " style="background-color: #c5c5c5; padding-top: 15px;padding-bottom: 15px;">Product
    </h1>
    <button type="button" class="btn btn-dark mb-2" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
      Add Product
    </button>
    <div class="modal fade " id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
      aria-labelledby="staticBackdropLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="staticBackdropLabel">Add Products</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>


          <div class="modal-body">
            <form action="/adminproducts" method="post" enctype="multipart/form-data">
              <div class="form-group">

                <label for="exampleFormControlInput1">Name</label>
                <input type="text" required class="form-control" id="exampleFormControlInput1" placeholder="Name"
                  name="name">
                <label for="exampleFormControlInput1">Category</label>
                <select name="category" class="form-control" id="exampleFormControlInput1">
                  <% catData.forEach((item)=>{

                    %><option>
                      <%=item.name%>
                    </option>
                    <% })%>
                </select>
                <label for="exampleFormControlInput1">Description</label>
                <input type="text" class="form-control" required id="exampleFormControlInput1" placeholder="Description"
                  name="description">
                <label for="exampleFormControlInput1">Stock</label>
                <input type="number" class="form-control" required id="exampleFormControlInput1" placeholder="Stock"
                  name="quantity">
                <label for="exampleFormControlInput1">Price</label>
                <input type="number" class="form-control" required id="exampleFormControlInput1" placeholder="Price"
                  name="price">
                <label for="file-upload" class="form-label">Images to upload</label>
                <input class="form-control" id="image"
                onchange="return fileValidations()"
                  type="file" name="image" multiple>

              </div>
          </div>
 <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="submit" class="btn btn-primary">Submit</button>
            </form>
          </div>
        </div>
      </div>
    </div>
  <div class="container-fluid ">
    <% if(product!=null) { %>
      <table id="example" class="table table-bordered table-striped ">
        <thead>

          <tr>
            <!-- <th>No.</th> -->
            <th>Name</th>
            <th>Category</th>

            <th>Status</th>
            <th>stock</th>
            <th>price</th>

            <!-- <th>Delete</th> -->
            <th>Edit</th>
            <th>Image</th>
            <th style="width: 100px;">discription</th>
          </tr>
        </thead>

        <tbody>
          <% if(product[0].image==null){%>
            <p>hai</p>
            <%}else{%>


              <% for (let i=0; i < product.length ; i++) { %>
                <tr>

                  <td>
                    <%=product[i].name%>
                  </td>
                  <td>
                    <%=product[i].category%>
                  </td>
                  <td>
                    <% if(product[i].status==true) {%>
                      <a class="btn btn-warning btn-sm" href="/adminproductsshow?id=<%= product[i]._id%>"
                        role="button">unlist</a>
                      <%}else{%>
                        <a class="btn btn-success btn-sm" href="/adminproductsshow?id=<%= product[i]._id%>"
                          role="button">list</a>
                        <%}%>
                  </td>
                  <td>
                    <%=product[i].quantity%>
                  </td>
                  <td>
                    <%=product[i].price%>
                  </td>
                  <td>
                    <div class="container-fluid px-4">

                      <button type="button" class="btn btn-dark mb-2" data-bs-toggle="modal"
                        data-bs-target="#productEdit<%=i%>">
                        <a class="btn btn-dark btn-sm"
                          role="button">EDIT</a>
                      </button>
                      
    <div class="modal fade " id="productEdit<%=i%>" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
    aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="staticBackdropLabel">Edit Products</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">


          <form action="/adminproductedit" method="post" enctype="multipart/form-data">

            <div class="form-group">
              <input type="text" name="id" value="<%= product[i]._id%>" hidden>

              <label for="exampleFormControlInput1"   >Name</label>
              <input type="text" class="form-control"  value="<%=product[i].name%>" id="exampleFormControlInput1" required
                name="name">
              <label for="exampleFormControlInput1">Category</label>

              <select name="category" class="form-control" id="exampleFormControlInput1">
                <% catData.forEach((item)=>{

                  %><option>
                    <%=item.name%>
                  </option>
                  <% })%>


              </select>

              <label for="exampleFormControlInput1">Description</label>
              <input type="text" class="form-control" id="exampleFormControlInput1" required value="<%=product[i].description%>"
                name="description">
              <label for="exampleFormControlInput1">Stock</label>
              <input type="text" class="form-control" value="<%=product[i].quantity%>" id="exampleFormControlInput1" required 
                name="quantity">
              <label for="exampleFormControlInput1">Price</label>
              <input type="text" class="form-control" id="exampleFormControlInput1" required value="<%=product[i].price%>"
                name="price">
              <label for="file-upload" class="form-label">Images to upload</label>
              <input class="form-control" id="file"
              onchange="return fileValidation()" type="file" name="image" multiple>


              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="submit" class="btn btn-primary">Submit</button>

          </form>
        </div>
      </div>
    </div>
  </div>
  
</div>
                    </div>
                  </td>

                  <td><img src="<%=product[i].image[0].url%>" style="width:50px;height:50px;"></td>

                  <td style="width: 100px;">
                    <%=product[i].description%>
                  </td>



                </tr>
                <% } %>
                  <%}%>


        </tbody>
      </table>
      <%}%>
  </div>
  </div>
  <script>
    $(document).ready(function () {
      var table = $('#example').DataTable({
        rowReorder: {
          selector: 'td:nth-child(2)'
        },
        responsive: true
      });
    });
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
		function fileValidations() {
			var fileInput =
				document.getElementById('image');
			
			var filePath = fileInput.value;
		
			// Allowing file type
			var allowedExtensions =
					/(\.jpg|\.jpeg|\.png)$/i;
			
			if (!allowedExtensions.exec(filePath)) {
				alert('Invalid file type');
				fileInput.value = '';
				return false;
			}
		}
	</script>


  <script>
		function fileValidation() {
			var fileInput =
				document.getElementById('file');
			
			var filePath = fileInput.value;
		
			// Allowing file type
			var allowedExtensions =
					/(\.jpg|\.jpeg|\.png)$/i;
			
			if (!allowedExtensions.exec(filePath)) {
				alert('Invalid file type');
				fileInput.value = '';
				return false;
			}
		}
	</script>

</body>

</html>